<app-customer-layout
    [userInitials]="getUserInitials()"
    (myProfile)="navigateToProfile()"
    (logout)="handleLogout()"
>
    <!-- Welcome Card -->
    <app-card variant="default" padding="none" class="welcome-card">
        <div class="welcome-avatar">
            <app-avatar
                [initials]="getUserInitials()"
                size="xl"
                shape="circle"
                [status]="'online'"
            />
        </div>
        <div class="welcome-content">
            <div class="welcome-text">
                <h1 class="welcome-title">
                    Welcome back, {{ userName() }}! ðŸ‘‹
                </h1>
                <p class="welcome-description">
                    This is your dashboard where you can manage bookings, track
                    shipments, review previous orders, and get support whenever
                    needed.
                </p>
                <p class="welcome-hint">
                    Use the quick actions or navigation menu above to get
                    started.
                </p>
            </div>
        </div>
    </app-card>

    <div class="home-grid">
        <!-- Quick Actions -->
        <app-card variant="outlined" padding="md" class="quick-actions-card">
            @if (isLoading()) {
            <app-skeleton variant="text" width="150px" height="24px" />
            <div style="margin-top: 20px">
                @for (i of [1,2,3]; track i) {
                <app-skeleton
                    variant="rounded"
                    height="48px"
                    style="margin-bottom: 12px"
                />
                }
            </div>
            } @else {
            <h2 class="section-title">Quick Actions</h2>
            <div class="quick-actions">
                <button class="action-button" (click)="navigateToNewBooking()">
                    <svg
                        class="action-icon"
                        fill="none"
                        stroke="currentColor"
                        viewBox="0 0 24 24"
                    >
                        <path
                            stroke-linecap="round"
                            stroke-linejoin="round"
                            stroke-width="2"
                            d="M12 6v6m0 0v6m0-6h6m-6 0H6"
                        />
                    </svg>
                    <span class="action-text">Start a New Booking</span>
                    <svg
                        class="action-arrow"
                        fill="none"
                        stroke="currentColor"
                        viewBox="0 0 24 24"
                    >
                        <path
                            stroke-linecap="round"
                            stroke-linejoin="round"
                            stroke-width="2"
                            d="M9 5l7 7-7 7"
                        />
                    </svg>
                </button>

                <button class="action-button" (click)="navigateToTracking()">
                    <svg
                        class="action-icon"
                        fill="none"
                        stroke="currentColor"
                        viewBox="0 0 24 24"
                    >
                        <path
                            stroke-linecap="round"
                            stroke-linejoin="round"
                            stroke-width="2"
                            d="M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"
                        />
                    </svg>
                    <span class="action-text">Track an Existing Shipment</span>
                    <svg
                        class="action-arrow"
                        fill="none"
                        stroke="currentColor"
                        viewBox="0 0 24 24"
                    >
                        <path
                            stroke-linecap="round"
                            stroke-linejoin="round"
                            stroke-width="2"
                            d="M9 5l7 7-7 7"
                        />
                    </svg>
                </button>

                <button class="action-button" (click)="navigateToHistory()">
                    <svg
                        class="action-icon"
                        fill="none"
                        stroke="currentColor"
                        viewBox="0 0 24 24"
                    >
                        <path
                            stroke-linecap="round"
                            stroke-linejoin="round"
                            stroke-width="2"
                            d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"
                        />
                    </svg>
                    <span class="action-text">View Previous Bookings</span>
                    <svg
                        class="action-arrow"
                        fill="none"
                        stroke="currentColor"
                        viewBox="0 0 24 24"
                    >
                        <path
                            stroke-linecap="round"
                            stroke-linejoin="round"
                            stroke-width="2"
                            d="M9 5l7 7-7 7"
                        />
                    </svg>
                </button>
            </div>
            }
        </app-card>

        <!-- Analytics Overview -->
        <div class="analytics-section">
            <h2 class="section-title">Overview & Analytics</h2>

            @if (isLoading()) {
            <div class="analytics-grid">
                @for (i of [1,2,3,4]; track i) {
                <app-card variant="outlined" padding="md">
                    <app-skeleton variant="text" width="120px" />
                    <app-skeleton
                        variant="text"
                        width="80px"
                        height="48px"
                        style="margin-top: 12px"
                    />
                    <app-skeleton
                        variant="text"
                        width="100px"
                        style="margin-top: 8px"
                    />
                </app-card>
                }
            </div>
            } @else {
            <div class="analytics-grid">
                <div class="stat-card">
                    <div class="stat-header">
                        <span class="stat-label">Total Bookings</span>
                    </div>
                    <div class="stat-value">
                        {{ analytics().totalBookings }}
                    </div>
                    <div class="stat-description">All time bookings</div>
                </div>

                <div class="stat-card stat-card-primary">
                    <div class="stat-header">
                        <span class="stat-label">Active Shipments</span>
                        <app-badge variant="primary" size="sm">Live</app-badge>
                    </div>
                    <div class="stat-value">
                        {{ analytics().activeShipments }}
                    </div>
                    <div class="stat-description">Currently in transit</div>
                </div>

                <div class="stat-card stat-card-success">
                    <div class="stat-header">
                        <span class="stat-label">Delivered</span>
                    </div>
                    <div class="stat-value">
                        {{ analytics().delivered }}
                    </div>
                    <div class="stat-description">Successfully delivered</div>
                </div>

                <div class="stat-card">
                    <div class="stat-header">
                        <span class="stat-label">Support Requests</span>
                    </div>
                    <div class="stat-value">
                        {{ analytics().supportRequests }}
                    </div>
                    <div class="stat-description">Open tickets</div>
                </div>
            </div>
            }
        </div>
    </div>

    <!-- Recent Activity -->
    <app-card variant="outlined" padding="md" class="activity-card">
        @if (isLoading()) {
        <app-skeleton variant="text" width="150px" height="24px" />
        <div style="margin-top: 20px">
            @for (i of [1,2,3]; track i) {
            <app-skeleton
                variant="text"
                height="20px"
                style="margin-bottom: 16px"
            />
            }
        </div>
        } @else {
        <h2 class="section-title">Recent Activity</h2>
        <div class="activity-list">
            @for (activity of recentActivities(); track activity.id) {
            <div class="activity-item">
                <div class="activity-dot"></div>
                <p class="activity-message">{{ activity.message }}</p>
            </div>
            }
        </div>
        }
    </app-card>
</app-customer-layout>
